<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Function Hashing - A Simple Idea with Powerful Implications (Unison) | Daniele Bonatto </title> <meta name="author" content="Daniele Bonatto"> <meta name="description" content="A thought experiment of how _hashed functions, as seen in the Unison language, could change programming. From faster builds to distributed computing and secure software, this post highlights potential applications and implications of this nice approach."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <meta name="google-site-verification" content="FgBzDEZ-uBkggCipS0HD3XQMihCYVm5Vo7SAHFL46Ds"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://dbonattoj.github.io/blog/2024/Unison/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://dbonattoj.github.io/"> <span class="font-weight-bold">Daniele </span> Bonatto </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">Welcome </a> </li> <li class="nav-item "> <a class="nav-link" href="/about/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Function Hashing - A Simple Idea with Powerful Implications (Unison)</h1> <p class="post-meta"> October 18, 2024 </p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/programming"> <i class="fa-solid fa-hashtag fa-sm"></i> programming</a>     ·   <a href="/blog/category/programming"> <i class="fa-solid fa-tag fa-sm"></i> programming</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Last year I came across an ingenious concept implemented in the <a href="https://www.unison-lang.org/" rel="external nofollow noopener" target="_blank">Unison programming language</a>. It’s such a simple yet underutilized idea, and I can’t help but imagine how nice it could be if adopted by mainstream languages like Python, Rust, or C++. Of course, making it work in those ecosystems would be a monumental challenge, especially with ABI compatibility and other complexities. Sadly, Unison remains a mostly unknown and experimental language, not intended for production. I hope other languages will discover this idea and implement it. I even explored the Python codebase to see if I could add it, but it would require far more time than I currently have.</p> <h1 id="the-idea">The Idea</h1> <p>The core idea is straightforward: for every function you write, Unison compute a hash based on its body and parameters. As long as neither changes, the hash remains the same.</p> <p>This seemingly minor tweak has profound implications:</p> <ol> <li> <strong>Faster Builds</strong> Instead of rebuilding the entire abstract syntax tree (AST) during compilation, you only need to rebuild the parts where hashes have changed. This can dramatically speed up build times, especially for large projects.</li> <li> <strong>Version Compatibility</strong> Functions with different bodies or parameters naturally produce different hashes. This makes managing versions trivial - functions from version 1 and version 2 can coexist seamlessly since their hashes distinguish them.</li> <li> <strong>Distributed Computing</strong> Imagine a distributed system where only the necessary functions are fetched on demand. When a remote machine needs to execute code, it can pull the required functions by their hashes, either from a main server or peer-to-peer from other machines. This approach minimizes unnecessary data transfer and enables efficient code sharing, reducing the need for complex distributed programming strategies during development.</li> </ol> <p>The idea has even more intriguing implications for how software can be written, shared, and executed. For a deeper dive, I highly recommend checking out <a href="https://www.unison-lang.org/docs/the-big-idea/" rel="external nofollow noopener" target="_blank">Unison’s explanation</a>.</p> <p>I extrapolated some other uses:</p> <ol> <li> <strong>Faster Builds and Incremental Deployment</strong> Beyond just faster builds, this idea could enable an incremental deployment system, including hot-swapping code at runtime. For example, in Python, imagine a scenario where your code fails after 3 hours of processing due to a critical error in a method. Instead of restarting the program, a mechanism could save the current state of execution, allow minor changes to be reverted (not to be confounded with <a href="https://spectrum.ieee.org/reversible-computing" rel="external nofollow noopener" target="_blank">reversible computing</a> which is on its way, <em>maybe</em>), and allow the developer to upload a new version of the function to continue execution without restarting.</li> <li> <strong>Immutable Function Repositories</strong> A function hash serves as a unique identifier, enabling the creation of immutable repositories of functions, akin to how Git tracks code. Instead of traditional package managers (e.g., pip or npm), repositories could fetch functions or modules directly by their hashes, ensuring precise versioning and eliminating dependency conflicts. This would shift software development from a project-based approach to a function-based one. While more suitable for pure functions, this idea could be extended to entire immutable objects, where full pure objects could also be hashed.</li> <li> <strong>Secure software</strong> Hashes ensure that function bodies remain unaltered by third parties. Shared repositories of hashed functions would allow everyone to verify the integrity of code. Organizations could maintain whitelists of vetted functions to deploy only approved code, leaving unchecked functions behind, thus enhancing software security.</li> <li> <strong>GPU Compute version</strong> GPU code is stored on the GPU and linked by the main program. Using hashes, we could dynamically relink different versions of GPU code at runtime, allowing hybrid functionalities between versions. For example, if a GPU doesn’t fully support the GPU version 2 firmware, the program could fallback to a hybrid setup - using <code class="language-plaintext highlighter-rouge">foo</code> from version 1 and <code class="language-plaintext highlighter-rouge">bar</code> from version 2 - adapting execution to hardware constraints.</li> <li> <strong>Dynamic Programming and Memoization</strong> Instead of manually crafting a data structure for memoization, hashes could enable automatic memoization. The system could associate already executed parameters with the hash of the function, streamlining dynamic programming tasks.</li> <li> <strong>Other ideas</strong>: <em>Better Debugging</em>, Function hashes could be logged during execution, enabling precise identification of function versions across builds. No more wondering whether a function changed between runs. <em>Reduced Code Duplication</em>, With smart semantic algorithms that interpret functions as syntactic trees, even if the same logic is rewritten in different styles, the system could generate the same hash, reducing redundant code.</li> </ol> <p>I can only begin to imagine the countless implications this simple idea might have.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/evolution-of-gaussian-splatting/">The Evolution of Scientific Curiosity - From Triangles to Gaussians in Graphics</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/inquiry-based-learning/">Inquiry-Based Learning - Navigating the Path to Deep Understanding in Class</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/dop-rust/">Data-Oriented Programming in Rust</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/acronym-tooltips/">From Print to Pixel - Transforming Acronym Usage in Academic Writing</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/docker-sed/">Docker Dependency Magic - Unleashing sed to Tailor Your Packages</a> </li> </div> </div> <div style="display: block;margin-left: auto;margin-right: auto;width:390px; height:auto"> <iframe width="390" height="640" src="https://d0603c1e.sibforms.com/serve/MUIFAIYEiBZci2ygtkVoUd-ftWVPvWukUBK5dppPV2jSzE61MhWvtpe5R71J9wkcXq-wNpRCLUGoa8BIudNdWoU2nYYmgzQ_8-LhexlS-ObD5rGi-VUlwPWBqrk3UqoDGYZgLqQ1_b4xY5gUH2hZoVI1xgBB2Wtl70DAf-CVJY8L-CvaKanNzjxjH_F2Vqzj19vV5D6S7qp6Nghr" frameborder="0" scrolling="auto" allowfullscreen style="display: block;margin-left: auto;margin-right: auto;max-width: 100%;"></iframe> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Daniele Bonatto. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. Last updated: January 30, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>